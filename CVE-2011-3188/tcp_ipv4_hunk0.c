



/*
 * INET An implementation of the TCP/IP protocol suite for the LINUX
 * operating system. INET is implemented using the BSD Socket
 * interface as the means of communication with the user level.
 *
 * Implementation of the Transmission Control Protocol(TCP).
 *
 * IPv4 specific functions
 *
 *
 * code split from:
 * linux/ipv4/tcp.c
 * linux/ipv4/tcp_input.c
 * linux/ipv4/tcp_output.c
 *
 * See tcp.c for author information
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version
 * 2 of the License, or (at your option) any later version.
 */

/*
 * Changes:
 * David S. Miller : New socket lookup architecture.
 * This code is dedicated to John Dyson.
 * David S. Miller : Change semantics of established hash,
 * half is devoted to TIME_WAIT sockets
 * and the rest go in the other half.
 * Andi Kleen : Add support for syncookies and fixed
 * some bugs: ip options weren't passed to
 * the TCP layer, missed a check for an
 * ACK bit.
 * Andi Kleen : Implemented fast path mtu discovery.
 * Fixed many serious bugs in the
 * request_sock handling and moved
 * most of it into the af independent code.
 * Added tail drop and some other bugfixes.
 * Added new listen semantics.
 * Mike McLagan : Routing by source
 * Juan Jose Ciarlante: ip_dynaddr bits
 * Andi Kleen: various fixes.
 * Vitaly E. Lavrov : Transparent proxy revived after year
 * coma.
 * Andi Kleen : Fix new listen.
 * Andi Kleen : Fix accept error reporting.
 * YOSHIFUJI Hideaki @USAGI and: Support IPV6_V6ONLY socket option, which
 * Alexey Kuznetsov allow both IPv4 and IPv6 sockets to bind
 * a single port at the same time.
 */


#include <linux/bottom_half.h>
#include <linux/types.h>
#include <linux/fcntl.h>
#include <linux/module.h>
#include <linux/random.h>
#include <linux/cache.h>
#include <linux/jhash.h>
#include <linux/init.h>
#include <linux/times.h>
#include <linux/slab.h>

#include <net/net_namespace.h>
#include <net/icmp.h>
#include <net/inet_hashtables.h>
#include <net/tcp.h>
#include <net/transp_v6.h>
#include <net/ipv6.h>
#include <net/inet_common.h>
#include <net/timewait_sock.h>
#include <net/xfrm.h>
#include <net/netdma.h>

#include <linux/inet.h>
#include <linux/ipv6.h>
#include <linux/stddef.h>
#include <linux/proc_fs.h>
#include <linux/seq_file.h>

#include <linux/crypto.h>
#include <linux/scatterlist.h>

int sysctl_tcp_tw_reuse __read_mostly;
int sysctl_tcp_low_latency __read_mostly;
EXPORT_SYMBOL(sysctl_tcp_low_latency);


#ifdef CONFIG_TCP_MD5SIG
static struct tcp_md5sig_key *tcp_v4_md5_do_lookup(struct sock *sk,
						   __be32 addr);
static int tcp_v4_md5_hash_hdr(char *md5_hash, struct tcp_md5sig_key *key,
			       __be32 daddr, __be32 saddr, struct tcphdr *th);
#else
static inline
struct tcp_md5sig_key *tcp_v4_md5_do_lookup(struct sock *sk, __be32 addr)
{
	return NULL;
}