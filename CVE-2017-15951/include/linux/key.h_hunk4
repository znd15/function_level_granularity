
extern void key_set_timeout(struct key *, unsigned);

/*
 * The permissions required on a key that we're looking up.
 */
#define KEY_NEED_VIEW 0x01	/* Require permission to view attributes */
#define KEY_NEED_READ 0x02	/* Require permission to read content */
#define KEY_NEED_WRITE 0x04	/* Require permission to update / modify */
#define KEY_NEED_SEARCH 0x08	/* Require permission to search (keyring) or find (key) */
#define KEY_NEED_LINK 0x10	/* Require permission to link */
#define KEY_NEED_SETATTR 0x20	/* Require permission to change attributes */
#define KEY_NEED_ALL 0x3f	/* All the above permissions */

/**
 * key_is_instantiated - Determine if a key has been positively instantiated
 * @key: The key to check.
 *
 * Return true if the specified key has been positively instantiated, false
 * otherwise.
 */
static inline bool key_is_instantiated(const struct key *key)
{
	return test_bit(KEY_FLAG_INSTANTIATED, &key->flags) &&
		!test_bit(KEY_FLAG_NEGATIVE, &key->flags);
}