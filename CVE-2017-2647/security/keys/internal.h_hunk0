
struct keyring_search_context {
	struct keyring_index_key index_key;
	const struct cred	*cred;
	struct key_match_data	match_data;
	unsigned		flags;
#define KEYRING_SEARCH_NO_STATE_CHECK 0x0001	/* Skip state checks */
#define KEYRING_SEARCH_DO_STATE_CHECK 0x0002	/* Override NO_STATE_CHECK */
#define KEYRING_SEARCH_NO_UPDATE_TIME 0x0004	/* Don't update times */
#define KEYRING_SEARCH_NO_CHECK_PERM 0x0008	/* Don't check permissions */
#define KEYRING_SEARCH_DETECT_TOO_DEEP 0x0010	/* Give an error on excessive depth */

	int (*iterator)(const void *object, void *iterator_data);

	/* Internal stuff */
	int			skipped_ret;
	bool			possessed;
	key_ref_t		result;
	struct timespec		now;
}