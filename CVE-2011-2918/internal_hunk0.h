
struct ring_buffer {
	atomic_t			refcount;
	struct rcu_head			rcu_head;
#ifdef CONFIG_PERF_USE_VMALLOC
	struct work_struct		work;
	int				page_order;	/* allocation order */
#endif
	int				nr_pages;	/* nr of data pages */
	int				writable;	/* are we writable */

	atomic_t			poll;		/* POLL_ for wakeups */

	local_t				head;		/* write position */
	local_t				nest;		/* nested writers */
	local_t				events;		/* event limit */
	local_t				wakeup;		/* wakeup stamp */
	local_t				lost;		/* nr records lost */

	long				watermark;	/* wakeup watermark */

	struct perf_event_mmap_page	*user_page;
	void				*data_pages[0];
}